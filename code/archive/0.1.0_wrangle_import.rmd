---
title: "ARIC Project"
author: "Anish Shah"
date: "February 27th, 2018"
output: 
  pdf_document: 
    highlight: tango
editor_options: 
  chunk_output_type: console
---

```{r setup, global_options, include=FALSE}

knitr::opts_chunk$set(
  cache = FALSE,
  warning = TRUE,
  echo = FALSE,
  message = FALSE,
  results = "asis"
)
```


# INTRODUCTION

## Hypothesis

Our study goal is to examine 2-minute high frequency heart rate variability (V1, V4) and the longitudinal relationship with anger (V2, V4) and the cross-sectional relationship with vital exhaustion and social support (V2). We expect that a low heart rate variability will correlate with increased anger, increased exhaustion, and decreased social support. In addition, we expect that an improvement over the course of follow-up in the psychosocial state of anger will result in an increased heart rate variability.

## Version control

0.1.0 Data import


# DATA INTAKE

## Libraries

```{r}

library(tidyverse)
library(lubridate)
library(rio)
library(broom)
library(compareGroups)
```

## Data import

### Visit 1 data

```{r}

# Read in table
v1d <- read_csv("v1/DERIVE13.dat", col_names = TRUE)

# Select only important columns
svar <- c(
  "ID",
  "DRNKR01",
  "BMI01",
  "PRVCHD05",
  "MDDXMI02",
  "PREVMI05",
  "HXOFMI02",
  "DIABTS03",
  "HYPERT05",
  "HYPTMD01",
  "CHOLMDCODE01",
  "V1AGE01",
  "V1DATE01",
  "BIRTHDAT",
  "GENDER",
  "RACEGRP",
  "PLAQUE01",
  "CIGT01",
  "CIGTYR01"
)
v1d <- v1d[c(svar)]

# Format data
v1d$V1DATE01 <- dmy(v1d$V1DATE01)
v1d$BIRTHDAT <- dmy(v1d$BIRTHDAT)

# Clean unused data
rm(svar)
```

### Visit 2 data

```{r}

## Derived variables

# Selected variables
svar <- c(
  "ID",
  "DRNKR21",
  "BMI21",
  "PRVCHD21",
  "MDDXMI21",
  "HXOFMI21",
  "DIABTS23",
  "ECGMI24",
  "PRVSTR21",
  "HYPERT25",
  "HYPTMD21",
  "CHOLMDCODE21",
  "V2AGE22",
  "V2DATE21",
  "PLAQUE21",
  "CIGT21"
)

# Intake and format variables
v2d <- read_csv("v2/DERIVE2_10.dat", col_names = TRUE)
v2d <- v2d[c(svar)]
v2d$V2DATE21 <- dmy(v2d$V2DATE21)

## Intake of V2 psychosocial metrics (Health and Life Profile).

# Social support
hpa <- read_csv("v2/HPAA.dat", col_names = TRUE)
hpa$HPAA30 <- dmy(hpa$HPAA30)

# Vital exhaustion
hpb <- read_csv("v2/HPBA.dat", col_names = TRUE)
hpb$HPBA22 <- dmy(hpb$HPBA22)

# Spielberger anger trait
hpc2 <- read_csv("v2/HPCA.dat", col_names = TRUE)
hpc2$HPCA11 <- dmy(hpc2$HPCA11)

# Clean up
rm(svar)
```

### Visit 4 data

```{r}

## Derived variables from visit 4

# Selected variables.
svar <- c(
  "ID",
  "DRNKR41",
  "BMI41",
  "PRVCHD43",
  "MDDXMI41",
  "HXOFMI41",
  "DIABTS42",
  "ECGMI41",
  "PRVSTR41",
  "HYPERT45",
  "HYPTMD41",
  "CHOLMDCODE41",
  "V4AGE41",
  "V4DATE41",
  "PLAQUE42",
  "CIGT41"
)


v4d <- read_csv("v4/DERIVE46.dat", col_names = TRUE)
v4d <- v4d[c(svar)]
v4d$V4DATE41 <- dmy(v4d$V4DATE41)

## Psychosocial metric

# Spielberger anger trait at visit 4.
hpc4 <- read_csv("v4/HPCB04.dat", col_names = TRUE)
hpc4$HPCB11 <- dmy(hpc4$HPCB11)

# Clean up data
rm(svar)
```



### HRV data

```{r}

## Data from HRV from visit 1, supine data.
hrv1 <- read_csv("hrv/f_hrv11b.dat", col_names = TRUE)

# Variables
svar <- c(
		  "ID",
		  "POSTV11",
		  "QCFLGV11",
		  "M_HRV11",
		  "HFV11",
		  "LFV11",
		  "VLFV11",
		  "TPV11",
		  "PNN50V11",
		  "MSSDV11",
		  "SDNNV11"
		  )
hrv1 <- hrv1[c(svar)]

## HRV data from visit 4.
hrv4 <- read_csv("hrv/hrv_re4f.dat", col_names = TRUE)

# Selected variables
svar <- c(
		  "ID",
		  "postV4r",
		  "qcflgv4R",
		  "m_hrv4r",
		  "HFv4r",
		  "LFv4r",
		  "VLFv4r",
		  "tpV4r",
		  "mssdV4r",
		  "pnn50V4r",
		  "sdnnV4r"
		  )
hrv4 <- hrv4[c(svar)]

```


### Outcomes data

```{r}

# Read in table
outcomes <- read_csv("outcomes/inc_by15.dat", col_names = TRUE)

# Select and trim data frame
svar <- c(
  "ID",
  "C7_DATEMI",
  "C7_DATEPROC",
  "UCOD",
  "DATED15",
  "DEAD15"
)
outcomes <- outcomes[c(svar)]

outcomes$C7_DATEMI <- mdy(outcomes$C7_DATEMI)
outcomes$C7_DATEPROC <- mdy(outcomes$C7_DATEPROC)
outcomes$DATED15 <- dmy(outcomes$DATED15)

```





